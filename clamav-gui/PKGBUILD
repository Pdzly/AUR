# Maintainer: Rooki <aur at rooki dot xyz>
# Contributor: Calogero e Angelo Scarn√† <info@codelinsoft.it>
pkgname=clamav-gui
_pkgname=ClamAV-GUI-QT6-1.1.8-1.2.src.rpm
__pkgname=ClamAV-GUI-QT6-1.1.8
pkgver=1.1.6
pkgrel=2
pkgdesc="This application provides a graphical user interface for clamav and freshclam with an integrated service menu for Konqueror/Dolphin to scan files directly from your file manager."
url="https://github.com/wusel1007/clamav-gui"
arch=('x86_64')
depends=('qt6-base' 'qt6-connectivity' 'qt6-declarative' 'qt6-svg' 'qt6-tools'  'qt6-translations' 'clamav' 'desktop-file-utils')
license=(GPLv3)
source=(
        "$_pkgname::https://files06.pling.com/api/files/download/j/eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjE3NjQyMzg2OTAiLCJ1IjpudWxsLCJsdCI6ImRvd25sb2FkIiwicyI6IjZlYjNlY2VmMTljMDdjMDg3MTJmOWRkMGJiZGEwZTA2MDQzMzFkYTU0NmVjOWE0NWIzM2VjMjJiMDdhYzRiNjI1NDljNDAyNzE5YTA3NWZhZGE1ZTBmNDdjZDZmNDUzOGE2M2U0OTI0MjU5ZmNiZjFjYjlkMmU0ZDAxZTM1OWFiIiwidCI6MTc2NDU5NjMzNCwic3RmcCI6IiIsInN0aXAiOiIifQ.9cI2DU9M1s4EedgjyKD6A8p2MrlMRH6VXSmX92e6p14/ClamAV-GUI-QT6-1.1.8-1.x86-64.rpm"
       )
sha256sums=(
            "SKIP"
           )

package() {
    cd ${srcdir}/
    bsdtar -xf ${_pkgname} -C ${srcdir}
}

prepare() {
   cd ${srcdir}/
   tar -xf ${__pkgname}.tar.gz -C ${srcdir}
   mv ${__pkgname} ${pkgname}-${pkgver}
}

build() {
   cd "${srcdir}/${pkgname}-${pkgver}"
   qmake6 PREFIX=/usr
   make -j4
}

package() {
   cd "${srcdir}/${pkgname}-${pkgver}"
   make install DESTDIR=${pkgdir}
   install -Dm644  "${srcdir}/${pkgname}-${pkgver}/extra/ClamAV-GUI.desktop" "${pkgdir}/etc/xdg/autostart/ClamAV-GUI.desktop"
}